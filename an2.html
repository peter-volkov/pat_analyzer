<!DOCTYPE html>
<html class="ua_js_no">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta charset="utf-8"/>
    <title>
      Title of the page
    </title>

    <script src="js/xml2json.js"></script>
	<script src="js/zip.js"></script>
    <script src="https://x2js.googlecode.com/hg/xml2json.js"></script>
    <script src="http://yastatic.net/jquery/1.8.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-dateFormat/1.0/jquery.dateFormat.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/1.3.5/ZeroClipboard.min.js"></script>
    <script src="js/HashTable.js"></script>    
    <script src="//cdn.datatables.net/1.10.0/js/jquery.dataTables.js"></script>

    <script src="test_data.js"></script>
 
  <link rel="stylesheet" href="css/analyzer.table.css" id="tableScreenCSS"/>
  <link rel="stylesheet" href="css/jquery.dataTables.css"/> 
  <meta name="description" content=""/>
  </head>
  <body class="page">  
    <div class="body body_full_height">
      <div class="head head_position_relative">
        <h1 class="header header_type_main">
          Report Analyzer PHP Antimalware Tool
        </h1>
        <div class="head__uninstall">
          <button class="button button_size_s i-bem" data-bem="{&quot;button&quot;:{}}" role="button">
            Uninstall tool
          </button>
        </div>
        <h2 class="head__sub-header">
          Report for DOMAIN.COM
        </h2>
        <p class="head__description">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
        </p>
      </div>
        <div class="filter i-bem" data-bem="{&quot;filter&quot;:&quot;true&quot;}">
        <button class="filter__flag">
          <span class="filter__text-flag">
            Flag
          </span>
          <span class="filter__arrow">
          </span>
        </button><div class="popup popup_name_flag popup_visibility_hidden i-bem" data-bem="{&quot;popup&quot;:{}}">
          <div class="popup__content">
            <ul class="list i-bem" data-bem="{&quot;list&quot;:&quot;true&quot;}">
              <li class="list__line list__line_checked_yes" val="green" num="1">
                <span class="list__check">
                </span>
                <span class="list__indicate list__indicate_color_green">
                </span>
                <span class="list__text">
                  Статус 1
                </span>
              </li>
              <li class="list__line list__line_checked_yes" val="yellow" num="2">
                <span class="list__check">
                </span>
                <span class="list__indicate list__indicate_color_yellow">
                </span>
                <span class="list__text">
                  Статус 2
                </span>
              </li>
              <li class="list__line" val="red" num="3">
                <span class="list__check">
                </span>
                <span class="list__indicate list__indicate_color_red">
                </span>
                <span class="list__text">
                  Статус 3
                </span>
              </li>
            </ul>
          </div>
        </div><input class="filter__file-name" placeholder="File name or path"/><input class="filter__file-type" placeholder="File type"/><button class="filter__timeslot">
        <span class="filter__text-timeslot">Timeslot</span><span class="filter__arrow"></span></button><div class="popup popup_name_timeslot popup_visibility_hidden i-bem" data-bem="{&quot;popup&quot;:{}}">
        <div class="popup__content"><div class="m-datepicker m-datepicker_type_month m-datepicker_disable_change i-bem" data-bem="{&quot;m-datepicker&quot;:&quot;true&quot;}"></div></div>
        </div><button class="filter__filter-button filter__filter-button_theme_action">
          Filter
        </button>
      </div>

      <div class="body__content body__content_display_block">

       <table class="table" id="filesTable">
            <thead class="table__head">
                <th class="table__head-item table__head-item_type_flag"><span class="table__column-title" id="tableHeaderFlagSpan">Флаг</span>
                </th>
                <th class="table__head-item table__head-item_type_Filename"><span class="table__column-title table__column-title_sort_up">Имя файла</span>
                </th>
                <th class="table__head-item table__head-item_type_Size"><span class="table__column-title table__column-title_sort_down">Размер</span>
                </th>
                <th class="table__head-item table__head-item_type_Created"><span class="table__column-title">Создан</span>
                </th>
                <th class="table__head-item table__head-item_type_Modified"><span class="table__column-title">Изменен</span>
                </th>
                <th class="table__head-item table__head-item_type_Created"><span class="table__column-title">Владелец</span>
                </th>
                <th class="table__head-item table__head-item_type_Modified"><span class="table__column-title">Группа</span>
                </th>
                <th class="table__head-item table__head-item_type_Modified"><span class="table__column-title">Атрибуты</span>
                </th>
                <th class="table__head-item table__head-item_type_button">Действие</th>
            </thead>

        <tbody class="table__body">

          <tr class="table__line">
            <td class="table__item table__item_align_center">
              <span class="table__flag table__flag_color_yellow">
              </span>
            </td>
            <td class="table__item table__item_full-width_yes">
              ./server_malware
            </td>
            <td class="table__item">
              10779
            </td>
            <td class="table__item">
              20/02/2014 17:40:51
            </td>
            <td class="table__item">
              18/02/2014 15:29:42
            </td>

            <td class="table__item">
              18/02/2014 15:29:42
            </td>

            <td class="table__item">
              18/02/2014 15:29:42
            </td>

            <td class="table__item">
              232
            </td>

            
            <td class="table__item">
              <div class="button-group">
                <div class="popup popup_visibility_hidden i-bem" data-bem="{&quot;popup&quot;:{&quot;0&quot;:&quot;t&quot;,&quot;1&quot;:&quot;r&quot;,&quot;2&quot;:&quot;u&quot;,&quot;3&quot;:&quot;e&quot;}}">
                  <div class="popup__close">
                  </div>
                  <div class="popup__content">
                    <table class="table">
                      <tr class="table__line">
                        <td class="table__item table__item_bold_yes">
                          Owner
                        </td>
                        <td class="table__item">
                          Petrov
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
                <button class="button button_more_yes i-bem" data-bem="{&quot;button&quot;:{}}" role="button" type="button">
                  <div class="button__arrow">
                  </div>
                </button>
                <button class="button button_size_s i-bem" data-bem="{&quot;button&quot;:{}}" role="button">
                  Quarantine
                </button>
                <button class="button button_size_s i-bem" data-bem="{&quot;button&quot;:{}}" role="button">
                  Delete
                </button>
              </div>
            </td>
          </tr>


        </tbody>
      </table>


        <p class="paragraph">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
        </p>
        <form class="form">
          <h3 class="form__head">
            XML Recomendations
          </h3>
          <div class="form__textarea-wrapper">
            <textarea class="form__textarea">
            </textarea>
          </div>
          <div class="form__buttonarea form__buttonarea_align_right">
            <button class="button button_theme_action i-bem" data-bem="{&quot;button&quot;:{}}" role="button">
              Copy to Clipboard
            </button>
          </div>
        </form>
      </div>
      <div class="footer">
        <a class="b-link footer__item" href="#">
          Обратная связь
        </a>
        <a class="b-link footer__item" href="#">
          Помощь
        </a>
        <div class="footer__item footer__item_type_copyright">
          ©&nbsp;2001&mdash;2013
        </div>
      </div>
    </div>

    <script>

		function getFileInfoArray(json) {
			var fileInfoArrayArray = new Array;
			var fileDictDict = json.website_info.files.file;
			for(var fileDictName in fileDictDict) {
				var fileInfoArray = new Array;
				var fileDict = fileDictDict[fileDictName];

				fileInfoArray.push(fileDict['_detected']);
				fileInfoArray.push(fileDict['path']);
				fileInfoArray.push(fileDict['size']);
				fileInfoArray.push(fileDict.ctime);
				fileInfoArray.push(fileDict.mtime);
				//fileInfoArray.push($.format.date(new Date(fileDict.ctime * 1000), "yyyy-MM-dd HH:mm:ss"));
				//fileInfoArray.push($.format.date(new Date(fileDict.mtime * 1000), "yyyy-MM-dd HH:mm:ss"));
				fileInfoArray.push(fileDict['owner']);
				fileInfoArray.push(fileDict['group']);
				fileInfoArray.push(fileDict['access']);
				fileInfoArray.push({'md5': fileDict.md5, 'pos': fileDict._pos, 'snippet': fileDict._snippet, 'path': fileDict.path});

				fileInfoArrayArray.push(fileInfoArray);
			}
			return fileInfoArrayArray;             
		}

		function displayContents(json) {
				
			filesDataTable = $('#filesTable').dataTable({

			   "aLengthMenu": [[100, 10, 500, -1], [100, 10, 500, "All"]],

			   "iDisplayLength": 50,

			   //Localization
			   "oLanguage": {
					"sLengthMenu": "Отображать по _MENU_ записей",
					"sZeroRecords": "Ничего не найдено",
					"sInfo": "Отображается c _START_ по _END_ из _TOTAL_ файлов",
					"sInfoEmpty": "Нет файлов",
					"sInfoFiltered": "(всего записей _MAX_)",
					"sSearch":       "Поиск:",
					"sUrl":          "",
					"oPaginate": {
						"sFirst": "Первая",
						"sPrevious": "Предыдущая",
						"sNext": "Следующая",
						"sLast": "Последняя"
					},
					"oAria": {
						"sSortAscending":  ": активировать для сортировки столбца по возрастанию",
						"sSortDescending": ": активировать для сортировки столбцов по убыванию"			
					}
				},

				//Data source
				"aaData": getFileInfoArray(json),

				//Data preprocessing for rendering
				"aoColumnDefs": [

					//Detection flag field preprocessing        
					{
						"aTargets": [0],
						"mRender": function (flag, type, full) {
							if (flag == 'c') {
								return '<span class="table__flag table__flag_color_red"></span>';
							} else if (flag == 'w') {
								return '<span class="table__flag table__flag_color_yelllow"></span>';
							}
							return '<span class="table__flag table__flag_color_green"></span>';
						}

					},

					//File size field preprocessing
					{
						"aTargets": [2],
						"mRender": function (size, type, full) {
							if (size == -1) {
								return '[Каталог]';
							}
							return size;
						}
					},

					//Ctime and mtime fields preprocessing        
					{
						"aTargets": [3, 4],
						"sType": "date",
						"mRender": function (timestamp, type, full) {
							return $.format.date(new Date(timestamp * 1000), "yyyy-MM-dd HH:mm:ss");
						}
					},

					{
						"aTargets": [8],
						"sClass": "table__item",
						"mRender": function (detectionInfo, type, full) {                        
							var buttons = "<div class=\"button-group i-bem button-group_js_inited\"><div class=\"popup popup_visibility_hidden i-bem popup_js_inited\" data-bem=\"{&quot;popup&quot;:{&quot;0&quot;:&quot;t&quot;,&quot;1&quot;:&quot;r&quot;,&quot;2&quot;:&quot;u&quot;,&quot;3&quot;:&quot;e&quot;}}\"><div class=\"popup__close\"></div><div class=\"popup__content\"><table class=\"table\"><tbody><tr class=\"table__line\"><td class=\"table__item table__item_bold_yes\"> Hash </td><td class=\"table__item\">" + detectionInfo.md5 + "</td></tr></tbody></table></div></div><button class=\"button button_more_yes i-bem\" data-bem=\"{&quot;button&quot;:{}}\" role=\"button\" type=\"button\"><div class=\"button__arrow\"></div></button><button id=\"q_" + detectionInfo.md5 + "\" class=\"button button_size_s i-bem\" data-bem=\"{&quot;button&quot;:{}}\" role=\"button\" onclick=\"return add_quarantine('" + detectionInfo.md5 + "', '" + detectionInfo.path + "')\"><span class=\"button__text\">Карантин</span></button><button id=\"d_" + detectionInfo.md5 + "\" class=\"button button_size_s i-bem\" data-bem=\"{&quot;button&quot;:{}}\" role=\"button\" onclick=\"return add_delete('" + detectionInfo.md5 + "', '" + detectionInfo.path + "')\"><span class=\"button__text\">Удалить</span></button></div>";
							return buttons;
						}
					},

				]
			});
			
		};

        displayContents(test_data);

    </script>
    
    <script type="text/javascript" language="javascript" src="js/analyzer.table.js" defer></script>
    <script type="text/javascript">

        var client = new ZeroClipboard(document.getElementById("copyRecipeButton"), {
          moviePath: "//cdnjs.cloudflare.com/ajax/libs/zeroclipboard/1.3.5/ZeroClipboard.swf"
        });

        client.on("load", function(client) {
          client.on('dataRequested', function (client, args) {
              client.setText(document.getElementById('recipeTextarea').value);
          });
        });

    </script>

  </body>
</html>